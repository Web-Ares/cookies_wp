"use strict";!function(){var e=!0;$(function(){new i($(".preloader")),$.each($(".site__header"),function(){new n($(this))}),$.each($("[data-href]"),function(){new t($(this))}),$.each($(".slides"),function(){new o($(this))}),$.each($(".site__content-full"),function(){new s($(this))}),$.each($(".site_index"),function(){new a($(this))})});var i=function(e){var i=this,n=$(window),t=e,o=$("body"),s=function(){n.on({load:function(){d()}})},a=function(){o[0].preloader=i,s(),$("html").css({"overflow-y":"hidden"})},d=function(){t.addClass("preloader_loaded"),setTimeout(function(){t.remove(),$("html").css({"overflow-y":"scroll"}),$(".site").addClass("site__loaded")},500)};a()},n=function(i){var n=this,t=i,o=$(window),s=$("html"),a=t.find(".site__menu"),d=($(".site__content"),!1),l=!1,r=!0,c=0,h=t.find(".site__menu-btn"),f=0,u=function(){o.on({load:function(){f=o.width()},resize:function(){f!=o.width()&&(f=o.width()+1,o.width()>=1024&&(a.scrollTop(0),v(h)))},scroll:function(){d=o.scrollTop()>=2*t.innerHeight(),o.scrollTop()>=t.innerHeight()+20?r&&(r=!1,t.addClass("site__header_hide")):(r=!0,t.removeClass("site__header_hide")),d?t.hasClass("site__header_hide")&&setTimeout(function(){t.addClass("site__header_fixed"),t.removeClass("site__header_hide")},100):o.scrollTop()<=3*t.innerHeight()&&(t.removeClass("site__header_fixed"),t.removeClass("site__header_hidden")),o.scrollTop()<=10&&(t.removeClass("site__header_fixed"),t.removeClass("site__header_hidden"))},DOMMouseScroll:function(e){var i=e.originalEvent.detail;if(i){var n=i>0?1:-1;_(n)}n<0?l=!0:setTimeout(function(){l=!1},300)},mousewheel:function(e){var i=e.originalEvent.wheelDelta;if(i){var n=i>0?-1:1;_(n)}n<0?l=!0:setTimeout(function(){l=!1},300)}}),$(window).scroll(function(e){var i=$(this).scrollTop();if(i>c){_(1);var n=1}else{_(-1);var n=-1}c=i,n<0?l=!0:setTimeout(function(){l=!1},300)}),h.on({click:function(){$(this).hasClass("opened")?v($(this)):w($(this))}})},_=function(i){i>0&&!t.hasClass("site__header_hidden")&&!h.hasClass("opened")&&d&&!l&&t.addClass("site__header_hidden"),i<0&&t.hasClass("site__header_hidden")&&!h.hasClass("opened")&&d&&l&&e&&t.removeClass("site__header_hidden")},v=function(e){s.css({overflowY:"auto"}),e.removeClass("opened"),t.removeClass("opened-menu")},m=function(){t[0].obj=n,u()},w=function(e){e.addClass("opened"),t.addClass("opened-menu"),s.css({overflowY:"hidden"})};m()},t=function(i){var n=this,t=i,o=t,s=$("html"),a=$(window),d=$("html, body"),l=$(".site__header"),r=($(".popup__cookies-info"),function(){a.on({resize:function(){c()},scroll:function(){c()}}),o.on({click:function(){var i=$(this),n=i.attr("data-href"),t=$("."+n).offset().top;return $(".site__menu-nav_anchors a").removeClass("active"),i.addClass("active"),d.stop(!0,!1),d.animate({scrollTop:t},{duration:500,progress:function(){e=!1,l.addClass("site__header_hidden")},complete:function(){setTimeout(function(){e=!1},200),setTimeout(function(){e=!0},500)}}),s.css({overflowY:"auto"}),l.find(".site__menu-btn").removeClass("opened"),l.removeClass("opened-menu"),!1}})}),c=function(){for(var e=a.scrollTop(),i=$("body").find('[data-scroll="scroll"]'),n=(i.offset().top,0);n<i.length;n++){var t=$(i[n]),s=$(i[n]).offset().top-l.outerHeight(!0),d=$(i[n]).outerHeight(!0);if(e>s){var r=t.attr("class").split(" "),c=o.filter("[data-href="+r[0]+"]");o.removeClass("active"),c.addClass("active")}e>s+d&&o.removeClass("active")}},h=function(){t[0].obj=n,r()};h()},o=function(e){var i=this,n=e,t=$(window),o=function(){t.on({load:function(){s()},scroll:function(){s()}})},s=function(){var e=t.scrollTop(),i=t.height(),o=n.offset().top,s=o-e,a=1-s/i;a>.5&&(n.hasClass("slides_active")||n.addClass("slides_active"))},a=function(){n[0].slides=i,o()};a()},s=function(e){var i=this,n=e,t=$(window),o=$(".site__header"),s=0,a=function(){t.on({load:function(){s=t.width(),l()},resize:function(){s!=t.width()&&(s=t.width()+1,l())}})},d=function(){n[0].obj=i,a()},l=function(){var e=t.height();n.css({"min-height":e-o.innerHeight()-$(".site__main-title").outerHeight(!0)}),n.find(".contact-us").length&&t.width()>=1024?n.css({"min-height":""}):n.css({"min-height":e-o.innerHeight()-$(".site__main-title").outerHeight(!0)})};d()},a=function(e){var i=this,n=e,t=$(window),o=($("html, body"),function(){t.on({load:function(){setTimeout(function(){s()},100)}})}),s=function(){var e=window.location.hash.replace("#","");if(e){var i=$("."+window.location.hash.replace("#",""));i.length&&window.scrollTo(0,parseInt(i.offset().top))}},a=function(){n[0].obj=i,o()};a()}}();
!function(){$(function(){$(".popup").each(function(){new o($(this))})});var o=function(o){var n,t=this,i=40,p=$(".popup__open"),e=o,c=e.find(".popup__close, .popup__cancel"),s=e.find(".popup__wrap"),u=e.find(".popup__content"),d=$("html"),a=$(window),h=setTimeout(function(){},1),f=function(){a.height()-2*i-s.height()>0?s.css({top:(a.height()-2*i-s.height())/2}):s.css({top:0})},l=function(){var o,n=document.createElement("div");return n.className="popup__scrollbar-measure",document.body.appendChild(n),o=n.offsetWidth-n.clientWidth,document.body.removeChild(n),o},r=function(){e.css({overflowY:"hidden"}),d.css({overflowY:"auto",paddingRight:0}),e.removeClass("popup_opened"),e.addClass("popup_hide"),h=setTimeout(function(){e.css({overflowY:"scroll"}),e.removeClass("popup_hide")},300)},_=function(){e[0].obj=t,v()},v=function(){a.on({load:function(){n=a.width()},resize:function(){f(),a.width()>=1024&&n!=a.width()&&(n=a.width()+1,r())}}),p.on({click:function(){return $(this).hasClass("cookies-info_btn")?a.width()<1024?(w($(this).attr("data-popup")),!1):void 0:(w($(this).attr("data-popup")),!1)}}),s.on({click:function(o){o.stopPropagation()}}),e.on({click:function(){return r(),!1}}),c.on({click:function(){return r(),!1}})},w=function(o){m(o),d.css({overflowY:"hidden",paddingRight:l()}),e.addClass("popup_opened"),f()},m=function(o){var n=u.filter(".popup__"+o);u.css({display:"none"}),n.css({display:"block"})};_()}}();
"use strict";!function(){$(function(){$(document).bind("gform_confirmation_loaded",function(n,c){$(".sign-up").addClass("success")})})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5tYWluLmpzIiwianF1ZXJ5LnBvcHVwLmpzIiwianF1ZXJ5LmNvbmZpcm1hdGlvbi5qcyJdLCJuYW1lcyI6WyJnbG9iYWxTY3JvbGxGbGFnIiwiJCIsIlByZWxvYWRlciIsImVhY2giLCJNZW51IiwidGhpcyIsIlNjcm9sbFBhbmVsIiwiU2xpZGVzIiwiRnVsbEhlaWdodCIsIlNjcm9sbFRvSGFzaCIsIm9iaiIsIl9zZWxmIiwiX3dpbmRvdyIsIndpbmRvdyIsIl9wcmVsb2FkZXIiLCJfYm9keSIsIl9hZGRFdmVudHMiLCJvbiIsImxvYWQiLCJfc2hvd1NpdGUiLCJfaW5pdCIsInByZWxvYWRlciIsImNzcyIsIm92ZXJmbG93LXkiLCJhZGRDbGFzcyIsInNldFRpbWVvdXQiLCJyZW1vdmUiLCJfb2JqIiwiX2h0bWwiLCJfbWVudSIsImZpbmQiLCJfYWN0aW9uIiwiX2FjdGlvbjIiLCJfZmxhZ0hpZGUiLCJsYXN0U2Nyb2xsVG9wIiwiX3Nob3dNZW51QnRuIiwiX2dsb2JhbFdpZHRoIiwid2lkdGgiLCJyZXNpemUiLCJzY3JvbGxUb3AiLCJfY2xvc2VNZW51Iiwic2Nyb2xsIiwiaW5uZXJIZWlnaHQiLCJyZW1vdmVDbGFzcyIsImhhc0NsYXNzIiwiRE9NTW91c2VTY3JvbGwiLCJlIiwiZGVsdGEiLCJvcmlnaW5hbEV2ZW50IiwiZGV0YWlsIiwiZGlyZWN0aW9uIiwiX2NoZWNrU2Nyb2xsIiwibW91c2V3aGVlbCIsIndoZWVsRGVsdGEiLCJldmVudCIsInN0IiwiY2xpY2siLCJfb3Blbk1lbnUiLCJlbGVtIiwib3ZlcmZsb3dZIiwiX2xpbmtzIiwiX2RvbSIsIl9oZWFkZXIiLCJfY2hhbmdlQWN0aXZlIiwiY3VySXRlbSIsIm5ld0NsYXNzIiwiYXR0ciIsIm5leHRJdGVtVG9wIiwib2Zmc2V0IiwidG9wIiwic3RvcCIsImFuaW1hdGUiLCJkdXJhdGlvbiIsInByb2dyZXNzIiwiY29tcGxldGUiLCJpdGVtIiwiaSIsImxlbmd0aCIsImN1ciIsIml0ZW1DdXIiLCJvdXRlckhlaWdodCIsIml0ZW1IZWlnaHQiLCJjdXJDbGFzcyIsInNwbGl0IiwiY3VyTGluayIsImZpbHRlciIsImN1clNjcm9sbCIsIndpbmRvd0giLCJoZWlnaHQiLCJ0b3BQb3MiLCJ0b3BJbldpbmRvdyIsInZpc2libGVQZXJjZW50Iiwic2xpZGVzIiwiX3NldEhlaWdodCIsIm1pbi1oZWlnaHQiLCJfc2Nyb2xsVG8iLCJoYXNoIiwibG9jYXRpb24iLCJyZXBsYWNlIiwic2Nyb2xsVG8iLCJwYXJzZUludCIsIlBvcHVwIiwiX3BvcHVwUGFkZGluZyIsIl9idG5TaG93IiwiX2J0bkNsb3NlIiwiX3dyYXAiLCJfY29udGVudHMiLCJfc2Nyb2xsQ29udGVpbmVyIiwiX3RpbWVyIiwiX2NlbnRlcldyYXAiLCJfZ2V0U2Nyb2xsV2lkdGgiLCJzY3JvbGxCYXJXaWR0aCIsInNjcm9sbERpdiIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsImJvZHkiLCJhcHBlbmRDaGlsZCIsIm9mZnNldFdpZHRoIiwiY2xpZW50V2lkdGgiLCJyZW1vdmVDaGlsZCIsIl9oaWRlIiwicGFkZGluZ1JpZ2h0IiwiX29uRXZlbnRzIiwiX3Nob3ciLCJzdG9wUHJvcGFnYXRpb24iLCJfc2V0UG9wdXBDb250ZW50IiwiY3VyQ29udGVudCIsImRpc3BsYXkiLCJiaW5kIiwiZm9ybUlkIl0sIm1hcHBpbmdzIjoiQUFBQSxjQUNBLFdBRUksR0FBSUEsSUFBbUIsQ0FFdkJDLEdBQUcsV0FFQyxHQUFJQyxHQUFXRCxFQUFFLGVBRWpCQSxFQUFFRSxLQUFNRixFQUFHLGlCQUFtQixXQUUxQixHQUFJRyxHQUFPSCxFQUFHSSxTQUlsQkosRUFBRUUsS0FBTUYsRUFBRSxlQUFnQixXQUV0QixHQUFJSyxHQUFhTCxFQUFFSSxTQUl2QkosRUFBRUUsS0FBTUYsRUFBRSxXQUFZLFdBRWxCLEdBQUlNLEdBQVFOLEVBQUVJLFNBSWxCSixFQUFFRSxLQUFNRixFQUFFLHVCQUF3QixXQUU5QixHQUFJTyxHQUFZ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RyxFQUFRSyxJQUNKQyxLQUFNLFdBRUZrQixFQUFleEIsRUFBUXlCLFNBRzNCQyxPQUFRLFdBQ0p1RSxJQUVJakcsRUFBUXlCLFNBQVcsTUFFZkQsR0FBZ0J4QixFQUFReUIsVUFFeEJELEVBQWV4QixFQUFReUIsUUFBVSxFQUVqQ29GLFFBUWhCbEIsRUFBU3RGLElBQ0x1QyxNQUFPLFdBRUgsTUFBSXZELEdBQUVJLE1BQU11QyxTQUFTLG9CQUViaEMsRUFBUXlCLFFBQVUsTUFFbEJ1RixFQUFPM0gsRUFBR0ksTUFBTzZELEtBQU0sZ0JBQ2hCLEdBSFgsUUFTQTBELEVBQU8zSCxFQUFHSSxNQUFPNkQsS0FBTSxnQkFDaEIsTUFNbkJ1QyxFQUFNeEYsSUFDRnVDLE1BQU8sU0FBVVYsR0FDYkEsRUFBRStFLHFCQUdWbEcsRUFBS1YsSUFDRHVDLE1BQU8sV0FFSCxNQURBaUUsTUFDTyxLQUdmakIsRUFBVXZGLElBQ051QyxNQUFPLFdBRUgsTUFEQWlFLE1BQ08sTUFJbkJHLEVBQVEsU0FBVVQsR0FDZFcsRUFBa0JYLEdBRWxCUixFQUFpQnJGLEtBQ2JxQyxVQUFXLFNBQ1grRCxhQUFjWixNQUVsQm5GLEVBQUtILFNBQVUsZ0JBQ2ZxRixLQUdKaUIsRUFBbUIsU0FBVVgsR0FDekIsR0FBSVksR0FBYXJCLEVBQVVyQixPQUFRLFdBQWE4QixFQUVoRFQsR0FBVXBGLEtBQU8wRyxRQUFTLFNBQzFCRCxFQUFXekcsS0FBTzBHLFFBQVMsVUFRbkM1RztBQ2pLUixjQUNBLFdBR0luQixFQUFHLFdBRUNBLEVBQUVnSCxVQUFVZ0IsS0FBSyw0QkFBNkIsU0FBUzNFLEVBQU80RSxHQUUxRGpJLEVBQUUsWUFBWXVCLFNBQVMiLCJmaWxlIjoiY29uZmlybWF0aW9uLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuKCBmdW5jdGlvbigpe1xuXG4gICAgdmFyIGdsb2JhbFNjcm9sbEZsYWcgPSB0cnVlO1xuXG4gICAgJCggZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIG5ldyBQcmVsb2FkZXIoICQoJy5wcmVsb2FkZXInKSApO1xuXG4gICAgICAgICQuZWFjaCggJCggJy5zaXRlX19oZWFkZXInICksIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICBuZXcgTWVudSAoICQoIHRoaXMgKSApO1xuXG4gICAgICAgIH0gKTtcblxuICAgICAgICAkLmVhY2goICQoJ1tkYXRhLWhyZWZdJyksIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgbmV3IFNjcm9sbFBhbmVsKCAkKHRoaXMpICk7XG5cbiAgICAgICAgfSApO1xuXG4gICAgICAgICQuZWFjaCggJCgnLnNsaWRlcycpLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIG5ldyBTbGlkZXMoICQodGhpcykgKTtcblxuICAgICAgICB9ICk7XG5cbiAgICAgICAgJC5lYWNoKCAkKCcuc2l0ZV9fY29udGVudC1mdWxsJyksIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgbmV3IEZ1bGxIZWlnaHQoICQodGhpcykgKTtcblxuICAgICAgICB9ICk7XG5cbiAgICAgICAgJC5lYWNoKCAkKCcuc2l0ZV9pbmRleCcpLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIG5ldyBTY3JvbGxUb0hhc2goICQodGhpcykgKTtcblxuICAgICAgICB9ICk7XG5cbiAgICB9ICk7XG5cbiAgICB2YXIgUHJlbG9hZGVyID0gZnVuY3Rpb24gKG9iaikge1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfd2luZG93ID0gJCggd2luZG93ICksXG4gICAgICAgICAgICBfcHJlbG9hZGVyID0gb2JqLFxuICAgICAgICAgICAgX2JvZHkgPSAkKCdib2R5Jyk7XG5cbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcbiAgICAgICAgdmFyIF9hZGRFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGxvYWQ6IGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9zaG93U2l0ZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIF9ib2R5WzBdLnByZWxvYWRlciA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9hZGRFdmVudHMoKTtcblxuXG5cbiAgICAgICAgICAgICAgICAkKCdodG1sJykuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICdvdmVyZmxvdy15JzogJ2hpZGRlbidcbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfc2hvd1NpdGUgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIF9wcmVsb2FkZXIuYWRkQ2xhc3MoICdwcmVsb2FkZXJfbG9hZGVkJyApO1xuXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBfcHJlbG9hZGVyLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgICQoJ2h0bWwnKS5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdvdmVyZmxvdy15JzogJ3Njcm9sbCdcbiAgICAgICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgICAgICAkKCcuc2l0ZScpLmFkZENsYXNzKCAnc2l0ZV9fbG9hZGVkJyApO1xuXG4gICAgICAgICAgICAgICAgfSw1MDApO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAvL3B1YmxpYyBwcm9wZXJ0aWVzXG5cbiAgICAgICAgLy9wdWJsaWMgbWV0aG9kc1xuXG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuXG4gICAgdmFyIE1lbnUgPSBmdW5jdGlvbiggb2JqICkge1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQod2luZG93KSxcbiAgICAgICAgICAgIF9odG1sID0gJCgnaHRtbCcpLFxuICAgICAgICAgICAgX21lbnUgPSBfb2JqLmZpbmQoJy5zaXRlX19tZW51JyksXG4gICAgICAgICAgICBfY29udGVudCA9ICQoJy5zaXRlX19jb250ZW50JyksXG4gICAgICAgICAgICBfYWN0aW9uID0gZmFsc2UsXG4gICAgICAgICAgICBfYWN0aW9uMiA9IGZhbHNlLFxuICAgICAgICAgICAgX2ZsYWdIaWRlID0gdHJ1ZSxcbiAgICAgICAgICAgIGxhc3RTY3JvbGxUb3AgPSAwLFxuICAgICAgICAgICAgX3Nob3dNZW51QnRuID0gX29iai5maW5kKCcuc2l0ZV9fbWVudS1idG4nKSxcbiAgICAgICAgICAgIF9nbG9iYWxXaWR0aCA9IDA7XG5cbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcbiAgICAgICAgdmFyIF9hZGRFdmVudHMgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIF93aW5kb3cub24oIHtcbiAgICAgICAgICAgICAgICAgICAgbG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfZ2xvYmFsV2lkdGggPSBfd2luZG93LndpZHRoKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVzaXplOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfZ2xvYmFsV2lkdGggIT0gX3dpbmRvdy53aWR0aCgpICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2dsb2JhbFdpZHRoID0gX3dpbmRvdy53aWR0aCgpICsgMTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF93aW5kb3cud2lkdGgoKSA+PSAxMDI0ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9tZW51LnNjcm9sbFRvcCgwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Nsb3NlTWVudSggX3Nob3dNZW51QnRuICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnc2Nyb2xsJzogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfYWN0aW9uID0gX3dpbmRvdy5zY3JvbGxUb3AoKSA+PSBfb2JqLmlubmVySGVpZ2h0KCkgKiAyO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggX3dpbmRvdy5zY3JvbGxUb3AoKSA+PSBfb2JqLmlubmVySGVpZ2h0KCkrIDIwICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF9mbGFnSGlkZSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZmxhZ0hpZGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX29iai5hZGRDbGFzcyggJ3NpdGVfX2hlYWRlcl9oaWRlJyApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZmxhZ0hpZGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9vYmoucmVtb3ZlQ2xhc3MoICdzaXRlX19oZWFkZXJfaGlkZScgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfYWN0aW9uICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF9vYmouaGFzQ2xhc3MoICdzaXRlX19oZWFkZXJfaGlkZScgKSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX29iai5hZGRDbGFzcyggJ3NpdGVfX2hlYWRlcl9maXhlZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9vYmoucmVtb3ZlQ2xhc3MoICdzaXRlX19oZWFkZXJfaGlkZScgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDAgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBfd2luZG93LnNjcm9sbFRvcCgpIDw9IF9vYmouaW5uZXJIZWlnaHQoKSAqIDMgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfb2JqLnJlbW92ZUNsYXNzKCAnc2l0ZV9faGVhZGVyX2ZpeGVkJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9vYmoucmVtb3ZlQ2xhc3MoICdzaXRlX19oZWFkZXJfaGlkZGVuJyApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfd2luZG93LnNjcm9sbFRvcCgpIDw9IDEwICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX29iai5yZW1vdmVDbGFzcyggJ3NpdGVfX2hlYWRlcl9maXhlZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfb2JqLnJlbW92ZUNsYXNzKCAnc2l0ZV9faGVhZGVyX2hpZGRlbicgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICdET01Nb3VzZVNjcm9sbCc6IGZ1bmN0aW9uICggZSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlbHRhID0gZS5vcmlnaW5hbEV2ZW50LmRldGFpbDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBkZWx0YSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaXJlY3Rpb24gPSAoIGRlbHRhID4gMCApID8gMSA6IC0xO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCBkaXJlY3Rpb24gKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGRpcmVjdGlvbiA8IDAgICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGlvbjIgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGlvbjIgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMCApXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICdtb3VzZXdoZWVsJzogZnVuY3Rpb24gKCBlICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVsdGEgPSBlLm9yaWdpbmFsRXZlbnQud2hlZWxEZWx0YTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBkZWx0YSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaXJlY3Rpb24gPSAoIGRlbHRhID4gMCApID8gLTEgOiAxO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCBkaXJlY3Rpb24gKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGRpcmVjdGlvbiA8IDAgICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGlvbjIgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGlvbjIgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMCApXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uKGV2ZW50KXtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3QgPSAkKHRoaXMpLnNjcm9sbFRvcCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdCA+IGxhc3RTY3JvbGxUb3Ape1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoIDEgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IDFcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoIC0xICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaXJlY3Rpb24gPSAtMVxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGFzdFNjcm9sbFRvcCA9IHN0O1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICggZGlyZWN0aW9uIDwgMCAgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hY3Rpb24yID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hY3Rpb24yID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMCApXG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgX3Nob3dNZW51QnRuLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoICQoIHRoaXMgKS5oYXNDbGFzcyggJ29wZW5lZCcgKSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jbG9zZU1lbnUoICQoIHRoaXMgKSApXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9vcGVuTWVudSggJCggdGhpcyApICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfY2hlY2tTY3JvbGwgPSBmdW5jdGlvbiggZGlyZWN0aW9uICkge1xuXG4gICAgICAgICAgICAgICAgaWYoIGRpcmVjdGlvbiA+IDAgJiYgIV9vYmouaGFzQ2xhc3MoICdzaXRlX19oZWFkZXJfaGlkZGVuJyApICYmICFfc2hvd01lbnVCdG4uaGFzQ2xhc3MoICdvcGVuZWQnICkgJiYgX2FjdGlvbiAmJiAhX2FjdGlvbjIgKXtcblxuICAgICAgICAgICAgICAgICAgICBfb2JqLmFkZENsYXNzKCAnc2l0ZV9faGVhZGVyX2hpZGRlbicgKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmKCBkaXJlY3Rpb24gPCAwICYmIF9vYmouaGFzQ2xhc3MoICdzaXRlX19oZWFkZXJfaGlkZGVuJyApICYmICFfc2hvd01lbnVCdG4uaGFzQ2xhc3MoICdvcGVuZWQnICkgICYmIF9hY3Rpb24gJiYgX2FjdGlvbjIgJiYgZ2xvYmFsU2Nyb2xsRmxhZyApe1xuXG4gICAgICAgICAgICAgICAgICAgIF9vYmoucmVtb3ZlQ2xhc3MoJ3NpdGVfX2hlYWRlcl9oaWRkZW4nKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9jbG9zZU1lbnUgPSBmdW5jdGlvbiggZWxlbSApIHtcblxuICAgICAgICAgICAgICAgIF9odG1sLmNzcygge1xuICAgICAgICAgICAgICAgICAgICBvdmVyZmxvd1k6ICdhdXRvJ1xuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIGVsZW0ucmVtb3ZlQ2xhc3MoICdvcGVuZWQnICk7XG4gICAgICAgICAgICAgICAgX29iai5yZW1vdmVDbGFzcyggJ29wZW5lZC1tZW51JyApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBfb2JqWyAwIF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9vcGVuTWVudSA9IGZ1bmN0aW9uKCBlbGVtICkgIHtcblxuICAgICAgICAgICAgICAgIGVsZW0uYWRkQ2xhc3MoICdvcGVuZWQnICk7XG4gICAgICAgICAgICAgICAgX29iai5hZGRDbGFzcyggJ29wZW5lZC1tZW51JyApO1xuXG4gICAgICAgICAgICAgICAgX2h0bWwuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgIG92ZXJmbG93WTogJ2hpZGRlbidcbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuXG4gICAgdmFyIFNjcm9sbFBhbmVsID0gZnVuY3Rpb24gKCBvYmogKSB7XG5cbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcbiAgICAgICAgICAgIF9vYmogPSBvYmosXG4gICAgICAgICAgICBfbGlua3MgPSBfb2JqLFxuICAgICAgICAgICAgX2h0bWwgPSAkKCdodG1sJyksXG4gICAgICAgICAgICBfd2luZG93ID0gJCh3aW5kb3cpLFxuICAgICAgICAgICAgX2RvbSA9ICAkKCAnaHRtbCwgYm9keScpLFxuICAgICAgICAgICAgX2hlYWRlciA9ICQoJy5zaXRlX19oZWFkZXInKSxcbiAgICAgICAgICAgIF9wb3B1cCA9ICQoJy5wb3B1cF9fY29va2llcy1pbmZvJyk7XG5cbiAgICAgICAgdmFyIF9hZGRFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hhbmdlQWN0aXZlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJ3Njcm9sbCc6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2NoYW5nZUFjdGl2ZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICBfbGlua3Mub24oIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VySXRlbSA9ICQoIHRoaXMgKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdDbGFzcyA9IGN1ckl0ZW0uYXR0cignZGF0YS1ocmVmJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dEl0ZW1Ub3AgPSAkKCAnLicgKyBuZXdDbGFzcyAgKS5vZmZzZXQoKS50b3A7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnLnNpdGVfX21lbnUtbmF2X2FuY2hvcnMgYScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckl0ZW0uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfZG9tLnN0b3AoIHRydWUsIGZhbHNlICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfZG9tLmFuaW1hdGUoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY3JvbGxUb3A6IG5leHRJdGVtVG9wXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogNTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2dyZXNzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbFNjcm9sbEZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2hlYWRlci5hZGRDbGFzcyggJ3NpdGVfX2hlYWRlcl9oaWRkZW4nICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU2Nyb2xsRmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAyMDAgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdsb2JhbFNjcm9sbEZsYWcgPSB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDUwMCApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9odG1sLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJmbG93WTogJ2F1dG8nXG4gICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9oZWFkZXIuZmluZCgnLnNpdGVfX21lbnUtYnRuJykucmVtb3ZlQ2xhc3MoICdvcGVuZWQnICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaGVhZGVyLnJlbW92ZUNsYXNzKCAnb3BlbmVkLW1lbnUnICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2NoYW5nZUFjdGl2ZSA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxUb3AgPSBfd2luZG93LnNjcm9sbFRvcCgpLFxuICAgICAgICAgICAgICAgICAgICBpdGVtID0gJCgnYm9keScpLmZpbmQoJ1tkYXRhLXNjcm9sbD1cInNjcm9sbFwiXScpLFxuICAgICAgICAgICAgICAgICAgICBpdGVtUG9zID0gaXRlbS5vZmZzZXQoKS50b3A7XG5cbiAgICAgICAgICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgaXRlbS5sZW5ndGg7IGkrKyApIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VyID0gJChpdGVtW2ldKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1DdXIgPSAkKGl0ZW1baV0pLm9mZnNldCgpLnRvcCAtIF9oZWFkZXIub3V0ZXJIZWlnaHQodHJ1ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtSGVpZ2h0ID0gJChpdGVtW2ldKS5vdXRlckhlaWdodCh0cnVlKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiggc2Nyb2xsVG9wID4gaXRlbUN1ciApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckNsYXNzID0gY3VyLmF0dHIoJ2NsYXNzJykuc3BsaXQoJyAnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJMaW5rID0gX2xpbmtzLmZpbHRlcihcIltkYXRhLWhyZWY9XCIrY3VyQ2xhc3NbMF0rXCJdXCIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfbGlua3MucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VyTGluay5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiggc2Nyb2xsVG9wID4gKCBpdGVtQ3VyICsgaXRlbUhlaWdodCApICl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9saW5rcy5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIF9vYmpbMF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICBfaW5pdCgpO1xuICAgIH07XG5cbiAgICB2YXIgU2xpZGVzID0gZnVuY3Rpb24gKG9iaikge1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQod2luZG93KTtcblxuICAgICAgICAvL3ByaXZhdGUgbWV0aG9kc1xuICAgICAgICB2YXIgX2FkZEV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKHtcbiAgICAgICAgICAgICAgICAgICAgbG9hZDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9jaGVja1Njcm9sbCA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICB2YXIgY3VyU2Nyb2xsID0gX3dpbmRvdy5zY3JvbGxUb3AoKSxcbiAgICAgICAgICAgICAgICAgICAgd2luZG93SCA9IF93aW5kb3cuaGVpZ2h0KCksXG4gICAgICAgICAgICAgICAgICAgIHRvcFBvcyA9IF9vYmoub2Zmc2V0KCkudG9wLFxuICAgICAgICAgICAgICAgICAgICB0b3BJbldpbmRvdyA9IHRvcFBvcy1jdXJTY3JvbGwsXG4gICAgICAgICAgICAgICAgICAgIHZpc2libGVQZXJjZW50ID0gMS0odG9wSW5XaW5kb3cvd2luZG93SCk7XG5cbiAgICAgICAgICAgICAgICBpZiggdmlzaWJsZVBlcmNlbnQgPiAuNSApe1xuICAgICAgICAgICAgICAgICAgICBpZiggIV9vYmouaGFzQ2xhc3MoJ3NsaWRlc19hY3RpdmUnKSApe1xuICAgICAgICAgICAgICAgICAgICAgICAgX29iai5hZGRDbGFzcygnc2xpZGVzX2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX29ialswXS5zbGlkZXMgPSBfc2VsZjtcbiAgICAgICAgICAgICAgICBfYWRkRXZlbnRzKCk7XG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgLy9wdWJsaWMgcHJvcGVydGllc1xuXG4gICAgICAgIC8vcHVibGljIG1ldGhvZHNcblxuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxuICAgIHZhciBGdWxsSGVpZ2h0ID0gZnVuY3Rpb24gKG9iaikge1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQod2luZG93KSxcbiAgICAgICAgICAgIF9oZWFkZXIgPSAkKCcuc2l0ZV9faGVhZGVyJyksXG4gICAgICAgICAgICBfZ2xvYmFsV2lkdGggPSAwO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfYWRkRXZlbnRzID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGxvYWQ6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2dsb2JhbFdpZHRoID0gX3dpbmRvdy53aWR0aCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3NldEhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggX2dsb2JhbFdpZHRoICE9IF93aW5kb3cud2lkdGgoKSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9nbG9iYWxXaWR0aCA9IF93aW5kb3cud2lkdGgoKSArIDE7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc2V0SGVpZ2h0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBfb2JqWyAwIF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9zZXRIZWlnaHQgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBfd2luZG93LmhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgX29iai5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgJ21pbi1oZWlnaHQnOiBoZWlnaHQgLSBfaGVhZGVyLmlubmVySGVpZ2h0KCkgLSAkKCcuc2l0ZV9fbWFpbi10aXRsZScpLm91dGVySGVpZ2h0KHRydWUpXG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgaWYoIF9vYmouZmluZCgnLmNvbnRhY3QtdXMnKS5sZW5ndGggKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoIF93aW5kb3cud2lkdGgoKSA+PSAxMDI0ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfb2JqLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtaW4taGVpZ2h0JzogJydcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfb2JqLmNzcygge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtaW4taGVpZ2h0JzogaGVpZ2h0IC0gX2hlYWRlci5pbm5lckhlaWdodCgpIC0gJCgnLnNpdGVfX21haW4tdGl0bGUnKS5vdXRlckhlaWdodCh0cnVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgX29iai5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdtaW4taGVpZ2h0JzogaGVpZ2h0IC0gX2hlYWRlci5pbm5lckhlaWdodCgpIC0gJCgnLnNpdGVfX21haW4tdGl0bGUnKS5vdXRlckhlaWdodCh0cnVlKVxuICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuXG4gICAgdmFyIFNjcm9sbFRvSGFzaCA9IGZ1bmN0aW9uICggb2JqICkge1xuXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQod2luZG93KSxcbiAgICAgICAgICAgIF9kb20gPSAgJCgnaHRtbCwgYm9keScpO1xuXG4gICAgICAgIHZhciBfYWRkRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICBsb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3Njcm9sbFRvKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEwMCApO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9zY3JvbGxUbyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIGhhc2ggPSB3aW5kb3cubG9jYXRpb24uaGFzaC5yZXBsYWNlKCcjJywgJycpO1xuXG4gICAgICAgICAgICAgICAgaWYoIGhhc2ggKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW0gPSAkKCAnLicgKyB3aW5kb3cubG9jYXRpb24uaGFzaC5yZXBsYWNlKCcjJywgJycpICk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoIGVsZW0ubGVuZ3RoICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oIDAsIHBhcnNlSW50KCBlbGVtLm9mZnNldCgpLnRvcCApICk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBfb2JqWzBdLm9iaiA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9hZGRFdmVudHMoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuXG59ICkoKTsiLCIoIGZ1bmN0aW9uKCl7XG5cbiAgICAkKCBmdW5jdGlvbigpe1xuXG4gICAgICAgICQoICcucG9wdXAnICkuZWFjaChmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICBuZXcgUG9wdXAoJCh0aGlzKSk7XG5cbiAgICAgICAgfSk7XG5cbiAgICB9KTtcblxuICAgIHZhciBQb3B1cCA9IGZ1bmN0aW9uKCBvYmogKXtcblxuICAgICAgICAvL3ByaXZhdGUgcHJvcGVydGllc1xuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxuICAgICAgICAgICAgX3BvcHVwUGFkZGluZyA9IDQwLFxuICAgICAgICAgICAgX2J0blNob3cgPSAgJCggJy5wb3B1cF9fb3BlbicgKSxcbiAgICAgICAgICAgIF9vYmogPSBvYmosXG4gICAgICAgICAgICBfYnRuQ2xvc2UgPSBfb2JqLmZpbmQoICcucG9wdXBfX2Nsb3NlLCAucG9wdXBfX2NhbmNlbCcgKSxcbiAgICAgICAgICAgIF93cmFwID0gX29iai5maW5kKCAnLnBvcHVwX193cmFwJyApLFxuICAgICAgICAgICAgX2NvbnRlbnRzID0gX29iai5maW5kKCAnLnBvcHVwX19jb250ZW50JyApLFxuICAgICAgICAgICAgX3Njcm9sbENvbnRlaW5lciA9ICQoICdodG1sJyApLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQoIHdpbmRvdyApLFxuICAgICAgICAgICAgX2dsb2JhbFdpZHRoLFxuICAgICAgICAgICAgX3RpbWVyID0gc2V0VGltZW91dCggZnVuY3Rpb24oKXt9LCAxICk7XG5cbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcbiAgICAgICAgdmFyIF9jZW50ZXJXcmFwID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBpZiAoIF93aW5kb3cuaGVpZ2h0KCkgLSAoIF9wb3B1cFBhZGRpbmcgKiAyICkgLSBfd3JhcC5oZWlnaHQoKSA+IDAgKSB7XG4gICAgICAgICAgICAgICAgICAgIF93cmFwLmNzcyggeyB0b3A6ICggKCBfd2luZG93LmhlaWdodCgpIC0gKCBfcG9wdXBQYWRkaW5nICogMiApICkgLSBfd3JhcC5oZWlnaHQoKSApIC8gMiB9ICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgX3dyYXAuY3NzKCB7IHRvcDogMCB9ICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9nZXRTY3JvbGxXaWR0aCA9IGZ1bmN0aW9uICgpe1xuICAgICAgICAgICAgICAgIHZhciBzY3JvbGxEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyksXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbEJhcldpZHRoO1xuXG4gICAgICAgICAgICAgICAgc2Nyb2xsRGl2LmNsYXNzTmFtZSA9ICdwb3B1cF9fc2Nyb2xsYmFyLW1lYXN1cmUnO1xuXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCggc2Nyb2xsRGl2ICk7XG5cbiAgICAgICAgICAgICAgICBzY3JvbGxCYXJXaWR0aCA9IHNjcm9sbERpdi5vZmZzZXRXaWR0aCAtIHNjcm9sbERpdi5jbGllbnRXaWR0aDtcblxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoc2Nyb2xsRGl2KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBzY3JvbGxCYXJXaWR0aDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaGlkZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX29iai5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3dZOiAnaGlkZGVuJ1xuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICBfc2Nyb2xsQ29udGVpbmVyLmNzcygge1xuICAgICAgICAgICAgICAgICAgICBvdmVyZmxvd1k6ICdhdXRvJyxcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZ1JpZ2h0OiAwXG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgX29iai5yZW1vdmVDbGFzcyggJ3BvcHVwX29wZW5lZCcgKTtcbiAgICAgICAgICAgICAgICBfb2JqLmFkZENsYXNzKCAncG9wdXBfaGlkZScgKTtcblxuICAgICAgICAgICAgICAgIF90aW1lciA9IHNldFRpbWVvdXQoIGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICAgICAgX29iai5jc3MgKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJmbG93WTogJ3Njcm9sbCdcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgX29iai5yZW1vdmVDbGFzcyggJ3BvcHVwX2hpZGUnICk7XG4gICAgICAgICAgICAgICAgfSwgMzAwICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfaW5pdCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX29ialsgMCBdLm9iaiA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9vbkV2ZW50cygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9vbkV2ZW50cyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICBsb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9nbG9iYWxXaWR0aCA9IF93aW5kb3cud2lkdGgoKTtcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICByZXNpemU6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICBfY2VudGVyV3JhcCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggX3dpbmRvdy53aWR0aCgpID49IDEwMjQgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggX2dsb2JhbFdpZHRoICE9IF93aW5kb3cud2lkdGgoKSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZ2xvYmFsV2lkdGggPSBfd2luZG93LndpZHRoKCkgKyAxO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9oaWRlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuICAgICAgICAgICAgICAgIF9idG5TaG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggJCh0aGlzKS5oYXNDbGFzcygnY29va2llcy1pbmZvX2J0bicpICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF93aW5kb3cud2lkdGgoKSA8IDEwMjQgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3Nob3coICQoIHRoaXMgKS5hdHRyKCAnZGF0YS1wb3B1cCcgKSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc2hvdyggJCggdGhpcyApLmF0dHIoICdkYXRhLXBvcHVwJyApICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgICAgICBfd3JhcC5vbigge1xuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oIGUgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgX29iai5vbigge1xuICAgICAgICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgX2J0bkNsb3NlLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgX2hpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfc2hvdyA9IGZ1bmN0aW9uKCBjbGFzc05hbWUgKXtcbiAgICAgICAgICAgICAgICBfc2V0UG9wdXBDb250ZW50KCBjbGFzc05hbWUgKTtcblxuICAgICAgICAgICAgICAgIF9zY3JvbGxDb250ZWluZXIuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgIG92ZXJmbG93WTogJ2hpZGRlbicsXG4gICAgICAgICAgICAgICAgICAgIHBhZGRpbmdSaWdodDogX2dldFNjcm9sbFdpZHRoKClcbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgX29iai5hZGRDbGFzcyggJ3BvcHVwX29wZW5lZCcgKTtcbiAgICAgICAgICAgICAgICBfY2VudGVyV3JhcCgpO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX3NldFBvcHVwQ29udGVudCA9IGZ1bmN0aW9uKCBjbGFzc05hbWUgKXtcbiAgICAgICAgICAgICAgICB2YXIgY3VyQ29udGVudCA9IF9jb250ZW50cy5maWx0ZXIoICcucG9wdXBfXycgKyBjbGFzc05hbWUgKTtcblxuICAgICAgICAgICAgICAgIF9jb250ZW50cy5jc3MoIHsgZGlzcGxheTogJ25vbmUnIH0gKTtcbiAgICAgICAgICAgICAgICBjdXJDb250ZW50LmNzcyggeyBkaXNwbGF5OiAnYmxvY2snIH0gKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgLy9wdWJsaWMgcHJvcGVydGllc1xuXG4gICAgICAgIC8vcHVibGljIG1ldGhvZHNcblxuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxufSApKCk7XG5cbiIsIlwidXNlIHN0cmljdFwiO1xuKCBmdW5jdGlvbigpe1xuXG5cbiAgICAkKCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgJChkb2N1bWVudCkuYmluZCgnZ2Zvcm1fY29uZmlybWF0aW9uX2xvYWRlZCcsIGZ1bmN0aW9uKGV2ZW50LCBmb3JtSWQpe1xuXG4gICAgICAgICAgICAkKCcuc2lnbi11cCcpLmFkZENsYXNzKCdzdWNjZXNzJyk7XG5cbiAgICAgICAgfSApO1xuXG5cbiAgICB9ICk7XG5cblxufSApKCk7Il19
