"use strict";!function(){var e=!0;$(function(){new n($(".preloader")),$.each($(".site__header"),function(){new i($(this))}),$.each($("[data-href]"),function(){new t($(this))}),$.each($(".slides"),function(){new o($(this))}),$.each($(".site__content-full"),function(){new s($(this))}),$.each($(".site_index"),function(){new a($(this))})});var n=function(e){var n=this,i=$(window),t=e,o=$("body"),s=function(){i.on({load:function(){d()}})},a=function(){o[0].preloader=n,s()},d=function(){t.addClass("preloader_loaded"),setTimeout(function(){t.remove(),$(".site").addClass("site__loaded")},500)};a()},i=function(n){var i=this,t=n,o=$(window),s=$("html"),a=t.find(".site__menu"),d=($(".site__content"),!1),c=!1,l=!0,r=0,h=t.find(".site__menu-btn"),f=0,u=function(){o.on({load:function(){f=o.width()},resize:function(){f!=o.width()&&(f=o.width()+1,o.width()>=1024&&(a.scrollTop(0),v(h)))},scroll:function(){d=o.scrollTop()>=2*t.innerHeight(),o.scrollTop()>=t.innerHeight()+20?l&&(l=!1,t.addClass("site__header_hide")):(l=!0,t.removeClass("site__header_hide")),d?t.hasClass("site__header_hide")&&setTimeout(function(){t.addClass("site__header_fixed"),t.removeClass("site__header_hide")},100):o.scrollTop()<=3*t.innerHeight()&&(t.removeClass("site__header_fixed"),t.removeClass("site__header_hidden")),o.scrollTop()<=10&&(t.removeClass("site__header_fixed"),t.removeClass("site__header_hidden"))},DOMMouseScroll:function(e){var n=e.originalEvent.detail;if(n){var i=n>0?1:-1;_(i)}i<0?c=!0:setTimeout(function(){c=!1},300)},mousewheel:function(e){var n=e.originalEvent.wheelDelta;if(n){var i=n>0?-1:1;_(i)}i<0?c=!0:setTimeout(function(){c=!1},300)}}),$(window).scroll(function(e){var n=$(this).scrollTop();if(n>r){_(1);var i=1}else{_(-1);var i=-1}r=n,i<0?c=!0:setTimeout(function(){c=!1},300)}),h.on({click:function(){$(this).hasClass("opened")?v($(this)):w($(this))}})},_=function(n){n>0&&!t.hasClass("site__header_hidden")&&!h.hasClass("opened")&&d&&!c&&t.addClass("site__header_hidden"),n<0&&t.hasClass("site__header_hidden")&&!h.hasClass("opened")&&d&&c&&e&&t.removeClass("site__header_hidden")},v=function(e){s.css({overflowY:"auto"}),e.removeClass("opened"),t.removeClass("opened-menu")},m=function(){t[0].obj=i,u()},w=function(e){e.addClass("opened"),t.addClass("opened-menu"),s.css({overflowY:"hidden"})};m()},t=function(n){var i=this,t=n,o=t,s=$("html"),a=$(window),d=$("html, body"),c=$(".site__header"),l=($(".popup__cookies-info"),function(){a.on({resize:function(){},scroll:function(){}}),o.on({click:function(){var n=$(this),i=n.attr("data-href"),t=$("."+i).offset().top-c.innerHeight();return o.removeClass("active"),n.addClass("active"),t=$("."+i).offset().top,d.stop(!0,!1),d.animate({scrollTop:t},{duration:500,progress:function(){e=!1,c.addClass("site__header_hidden")},complete:function(){setTimeout(function(){e=!1},200),setTimeout(function(){e=!0},500)}}),s.css({overflowY:"auto"}),c.find(".site__menu-btn").removeClass("opened"),c.removeClass("opened-menu"),!1}})}),r=function(){t[0].obj=i,l()};r()},o=function(e){var n=this,i=e,t=$(window),o=function(){t.on({load:function(){s()},scroll:function(){s()}})},s=function(){var e=t.scrollTop(),n=t.height(),o=i.offset().top,s=o-e,a=1-s/n;a>.5&&(i.hasClass("slides_active")||i.addClass("slides_active"))},a=function(){i[0].slides=n,o()};a()},s=function(e){var n=this,i=e,t=$(window),o=$(".site__header"),s=0,a=function(){t.on({load:function(){s=t.width(),c()},resize:function(){s!=t.width()&&(s=t.width()+1,c())}})},d=function(){i[0].obj=n,a()},c=function(){var e=t.height();i.css({"min-height":e-o.innerHeight()-$(".site__main-title").outerHeight(!0)}),i.find(".contact-us").length&&t.width()>=1024?i.css({"min-height":""}):i.css({"min-height":e-o.innerHeight()-$(".site__main-title").outerHeight(!0)})};d()},a=function(e){var n=this,i=e,t=$(window),o=($("html, body"),function(){t.on({load:function(){setTimeout(function(){s()},100)}})}),s=function(){var e=window.location.hash.replace("#","");if(e){var n=$("."+window.location.hash.replace("#",""));n.length&&window.scrollTo(0,parseInt(n.offset().top))}},a=function(){i[0].obj=n,o()};a()}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5tYWluLmpzIl0sIm5hbWVzIjpbImdsb2JhbFNjcm9sbEZsYWciLCIkIiwiUHJlbG9hZGVyIiwiZWFjaCIsIk1lbnUiLCJ0aGlzIiwiU2Nyb2xsUGFuZWwiLCJTbGlkZXMiLCJGdWxsSGVpZ2h0IiwiU2Nyb2xsVG9IYXNoIiwib2JqIiwiX3NlbGYiLCJfd2luZG93Iiwid2luZG93IiwiX3ByZWxvYWRlciIsIl9ib2R5IiwiX2FkZEV2ZW50cyIsIm9uIiwibG9hZCIsIl9zaG93U2l0ZSIsIl9pbml0IiwicHJlbG9hZGVyIiwiYWRkQ2xhc3MiLCJzZXRUaW1lb3V0IiwicmVtb3ZlIiwiX29iaiIsIl9odG1sIiwiX21lbnUiLCJmaW5kIiwiX2FjdGlvbiIsIl9hY3Rpb24yIiwiX2ZsYWdIaWRlIiwibGFzdFNjcm9sbFRvcCIsIl9zaG93TWVudUJ0biIsIl9nbG9iYWxXaWR0aCIsIndpZHRoIiwicmVzaXplIiwic2Nyb2xsVG9wIiwiX2Nsb3NlTWVudSIsInNjcm9sbCIsImlubmVySGVpZ2h0IiwicmVtb3ZlQ2xhc3MiLCJoYXNDbGFzcyIsIkRPTU1vdXNlU2Nyb2xsIiwiZSIsImRlbHRhIiwib3JpZ2luYWxFdmVudCIsImRldGFpbCIsImRpcmVjdGlvbiIsIl9jaGVja1Njcm9sbCIsIm1vdXNld2hlZWwiLCJ3aGVlbERlbHRhIiwiZXZlbnQiLCJzdCIsImNsaWNrIiwiX29wZW5NZW51IiwiZWxlbSIsImNzcyIsIm92ZXJmbG93WSIsIl9saW5rcyIsIl9kb20iLCJfaGVhZGVyIiwiY3VySXRlbSIsIm5ld0NsYXNzIiwiYXR0ciIsIm5leHRJdGVtVG9wIiwib2Zmc2V0IiwidG9wIiwic3RvcCIsImFuaW1hdGUiLCJkdXJhdGlvbiIsInByb2dyZXNzIiwiY29tcGxldGUiLCJjdXJTY3JvbGwiLCJ3aW5kb3dIIiwiaGVpZ2h0IiwidG9wUG9zIiwidG9wSW5XaW5kb3ciLCJ2aXNpYmxlUGVyY2VudCIsInNsaWRlcyIsIl9zZXRIZWlnaHQiLCJtaW4taGVpZ2h0Iiwib3V0ZXJIZWlnaHQiLCJsZW5ndGgiLCJfc2Nyb2xsVG8iLCJoYXNoIiwibG9jYXRpb24iLCJyZXBsYWNlIiwic2Nyb2xsVG8iLCJwYXJzZUludCJdLCJtYXBwaW5ncyI6IkFBQUEsY0FDQSxXQUVJLEdBQUlBLElBQW1CLENBRXZCQyxHQUFHLFdBRUMsR0FBSUMsR0FBV0QsRUFBRSxlQUVqQkEsRUFBRUUsS0FBTUYsRUFBRyxpQkFBbUIsV0FFMUIsR0FBSUcsR0FBT0gsRUFBR0ksU0FJbEJKLEVBQUVFLEtBQU1GLEVBQUUsZUFBZ0IsV0FFdEIsR0FBSUssR0FBYUwsRUFBRUksU0FJdkJKLEVBQUVFLEtBQU1GLEVBQUUsV0FBWSxXQUVsQixHQUFJTSxHQUFRTixFQUFFSSxTQUlsQkosRUFBRUUsS0FBTUYsRUFBRSx1QkFBd0IsV0FFOUIsR0FBSU8sR0FBWVAsRUFBRUksU0FJdEJKLEVBQUVFLEtBQU1GLEVBQUUsZUFBZ0IsV0FFdEIsR0FBSVEsR0FBY1IsRUFBRUksVUFNNUIsSUFBSUgsR0FBWSxTQUFVUSxHQUd0QixHQUFJQyxHQUFRTixLQUNSTyxFQUFVWCxFQUFHWSxRQUNiQyxFQUFhSixFQUNiSyxFQUFRZCxFQUFFLFFBR1ZlLEVBQWEsV0FFVEosRUFBUUssSUFDSkMsS0FBTSxXQUVGQyxRQU1aQyxFQUFRLFdBRUpMLEVBQU0sR0FBR00sVUFBWVYsRUFDckJLLEtBR0pHLEVBQVksV0FFUkwsRUFBV1EsU0FBVSxvQkFFckJDLFdBQVcsV0FDUFQsRUFBV1UsU0FDWHZCLEVBQUUsU0FBU3FCLFNBQVUsaUJBRXZCLEtBUVZGLE1BR0FoQixFQUFPLFNBQVVNLEdBR2pCLEdBQUlDLEdBQVFOLEtBQ1JvQixFQUFPZixFQUNQRSxFQUFVWCxFQUFFWSxRQUNaYSxFQUFRekIsRUFBRSxRQUNWMEIsRUFBUUYsRUFBS0csS0FBSyxlQUVsQkMsR0FEVzVCLEVBQUUsbUJBQ0gsR0FDVjZCLEdBQVcsRUFDWEMsR0FBWSxFQUNaQyxFQUFnQixFQUNoQkMsRUFBZVIsRUFBS0csS0FBSyxtQkFDekJNLEVBQWUs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QkFDWmlDLEVBQWUsRUFHZmxCLEVBQWEsV0FFVEosRUFBUUssSUFDSkMsS0FBTSxXQUVGZ0IsRUFBZXRCLEVBQVF1QixRQUN2QjZDLEtBR0o1QyxPQUFRLFdBRUFGLEdBQWdCdEIsRUFBUXVCLFVBRXhCRCxFQUFldEIsRUFBUXVCLFFBQVUsRUFFakM2QyxTQVFoQjVELEVBQVEsV0FDSkssRUFBTSxHQUFJZixJQUFNQyxFQUNoQkssS0FFSmdFLEVBQWEsV0FFVCxHQUFJTCxHQUFTL0QsRUFBUStELFFBRXJCbEQsR0FBS2dDLEtBQ0R3QixhQUFjTixFQUFTZCxFQUFRckIsY0FBZ0J2QyxFQUFFLHFCQUFxQmlGLGFBQVksS0FHbEZ6RCxFQUFLRyxLQUFLLGVBQWV1RCxRQUVyQnZFLEVBQVF1QixTQUFXLEtBRW5CVixFQUFLZ0MsS0FDRHdCLGFBQWMsS0FhdEJ4RCxFQUFLZ0MsS0FDRHdCLGFBQWNOLEVBQVNkLEVBQVFyQixjQUFnQnZDLEVBQUUscUJBQXFCaUYsYUFBWSxLQU9sRzlELE1BR0FYLEVBQWUsU0FBV0MsR0FFMUIsR0FBSUMsR0FBUU4sS0FDUm9CLEVBQU9mLEVBQ1BFLEVBQVVYLEVBQUVZLFFBR1pHLEdBRlFmLEVBQUUsY0FFRyxXQUVUVyxFQUFRSyxJQUNKQyxLQUFNLFdBRUZLLFdBQVksV0FFUjZELEtBRUQsVUFPZkEsRUFBWSxXQUVSLEdBQUlDLEdBQU94RSxPQUFPeUUsU0FBU0QsS0FBS0UsUUFBUSxJQUFLLEdBRTdDLElBQUlGLEVBQU8sQ0FFUCxHQUFJN0IsR0FBT3ZELEVBQUcsSUFBTVksT0FBT3lFLFNBQVNELEtBQUtFLFFBQVEsSUFBSyxJQUVsRC9CLEdBQUsyQixRQUVMdEUsT0FBTzJFLFNBQVUsRUFBR0MsU0FBVWpDLEVBQUtVLFNBQVNDLFFBT3hEL0MsRUFBUSxXQUNKSyxFQUFLLEdBQUdmLElBQU1DLEVBQ2RLLElBR1JJIiwiZmlsZSI6Im5vdC1mb3VuZC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbiggZnVuY3Rpb24oKXtcblxuICAgIHZhciBnbG9iYWxTY3JvbGxGbGFnID0gdHJ1ZTtcblxuICAgICQoIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICBuZXcgUHJlbG9hZGVyKCAkKCcucHJlbG9hZGVyJykgKTtcblxuICAgICAgICAkLmVhY2goICQoICcuc2l0ZV9faGVhZGVyJyApLCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgbmV3IE1lbnUgKCAkKCB0aGlzICkgKTtcblxuICAgICAgICB9ICk7XG5cbiAgICAgICAgJC5lYWNoKCAkKCdbZGF0YS1ocmVmXScpLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIG5ldyBTY3JvbGxQYW5lbCggJCh0aGlzKSApO1xuXG4gICAgICAgIH0gKTtcblxuICAgICAgICAkLmVhY2goICQoJy5zbGlkZXMnKSwgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICBuZXcgU2xpZGVzKCAkKHRoaXMpICk7XG5cbiAgICAgICAgfSApO1xuXG4gICAgICAgICQuZWFjaCggJCgnLnNpdGVfX2NvbnRlbnQtZnVsbCcpLCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgIG5ldyBGdWxsSGVpZ2h0KCAkKHRoaXMpICk7XG5cbiAgICAgICAgfSApO1xuXG4gICAgICAgICQuZWFjaCggJCgnLnNpdGVfaW5kZXgnKSwgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICBuZXcgU2Nyb2xsVG9IYXNoKCAkKHRoaXMpICk7XG5cbiAgICAgICAgfSApO1xuXG4gICAgfSApO1xuXG4gICAgdmFyIFByZWxvYWRlciA9IGZ1bmN0aW9uIChvYmopIHtcblxuICAgICAgICAvL3ByaXZhdGUgcHJvcGVydGllc1xuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQoIHdpbmRvdyApLFxuICAgICAgICAgICAgX3ByZWxvYWRlciA9IG9iaixcbiAgICAgICAgICAgIF9ib2R5ID0gJCgnYm9keScpO1xuXG4gICAgICAgIC8vcHJpdmF0ZSBtZXRob2RzXG4gICAgICAgIHZhciBfYWRkRXZlbnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICBsb2FkOiBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfc2hvd1NpdGUoKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfYm9keVswXS5wcmVsb2FkZXIgPSBfc2VsZjtcbiAgICAgICAgICAgICAgICBfYWRkRXZlbnRzKCk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfc2hvd1NpdGUgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIF9wcmVsb2FkZXIuYWRkQ2xhc3MoICdwcmVsb2FkZXJfbG9hZGVkJyApO1xuXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBfcHJlbG9hZGVyLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICAkKCcuc2l0ZScpLmFkZENsYXNzKCAnc2l0ZV9fbG9hZGVkJyApO1xuXG4gICAgICAgICAgICAgICAgfSw1MDApO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAvL3B1YmxpYyBwcm9wZXJ0aWVzXG5cbiAgICAgICAgLy9wdWJsaWMgbWV0aG9kc1xuXG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuXG4gICAgdmFyIE1lbnUgPSBmdW5jdGlvbiggb2JqICkge1xuXG4gICAgICAgIC8vcHJpdmF0ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHZhciBfc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICBfb2JqID0gb2JqLFxuICAgICAgICAgICAgX3dpbmRvdyA9ICQod2luZG93KSxcbiAgICAgICAgICAgIF9odG1sID0gJCgnaHRtbCcpLFxuICAgICAgICAgICAgX21lbnUgPSBfb2JqLmZpbmQoJy5zaXRlX19tZW51JyksXG4gICAgICAgICAgICBfY29udGVudCA9ICQoJy5zaXRlX19jb250ZW50JyksXG4gICAgICAgICAgICBfYWN0aW9uID0gZmFsc2UsXG4gICAgICAgICAgICBfYWN0aW9uMiA9IGZhbHNlLFxuICAgICAgICAgICAgX2ZsYWdIaWRlID0gdHJ1ZSxcbiAgICAgICAgICAgIGxhc3RTY3JvbGxUb3AgPSAwLFxuICAgICAgICAgICAgX3Nob3dNZW51QnRuID0gX29iai5maW5kKCcuc2l0ZV9fbWVudS1idG4nKSxcbiAgICAgICAgICAgIF9nbG9iYWxXaWR0aCA9IDA7XG5cbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcbiAgICAgICAgdmFyIF9hZGRFdmVudHMgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIF93aW5kb3cub24oIHtcbiAgICAgICAgICAgICAgICAgICAgbG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfZ2xvYmFsV2lkdGggPSBfd2luZG93LndpZHRoKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVzaXplOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfZ2xvYmFsV2lkdGggIT0gX3dpbmRvdy53aWR0aCgpICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2dsb2JhbFdpZHRoID0gX3dpbmRvdy53aWR0aCgpICsgMTtcblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF93aW5kb3cud2lkdGgoKSA+PSAxMDI0ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9tZW51LnNjcm9sbFRvcCgwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2Nsb3NlTWVudSggX3Nob3dNZW51QnRuICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnc2Nyb2xsJzogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfYWN0aW9uID0gX3dpbmRvdy5zY3JvbGxUb3AoKSA+PSBfb2JqLmlubmVySGVpZ2h0KCkgKiAyO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggX3dpbmRvdy5zY3JvbGxUb3AoKSA+PSBfb2JqLmlubmVySGVpZ2h0KCkrIDIwICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF9mbGFnSGlkZSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZmxhZ0hpZGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX29iai5hZGRDbGFzcyggJ3NpdGVfX2hlYWRlcl9oaWRlJyApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZmxhZ0hpZGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9vYmoucmVtb3ZlQ2xhc3MoICdzaXRlX19oZWFkZXJfaGlkZScgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfYWN0aW9uICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF9vYmouaGFzQ2xhc3MoICdzaXRlX19oZWFkZXJfaGlkZScgKSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX29iai5hZGRDbGFzcyggJ3NpdGVfX2hlYWRlcl9maXhlZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9vYmoucmVtb3ZlQ2xhc3MoICdzaXRlX19oZWFkZXJfaGlkZScgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDAgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCBfd2luZG93LnNjcm9sbFRvcCgpIDw9IF9vYmouaW5uZXJIZWlnaHQoKSAqIDMgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfb2JqLnJlbW92ZUNsYXNzKCAnc2l0ZV9faGVhZGVyX2ZpeGVkJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9vYmoucmVtb3ZlQ2xhc3MoICdzaXRlX19oZWFkZXJfaGlkZGVuJyApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCBfd2luZG93LnNjcm9sbFRvcCgpIDw9IDEwICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX29iai5yZW1vdmVDbGFzcyggJ3NpdGVfX2hlYWRlcl9maXhlZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfb2JqLnJlbW92ZUNsYXNzKCAnc2l0ZV9faGVhZGVyX2hpZGRlbicgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICdET01Nb3VzZVNjcm9sbCc6IGZ1bmN0aW9uICggZSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlbHRhID0gZS5vcmlnaW5hbEV2ZW50LmRldGFpbDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBkZWx0YSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaXJlY3Rpb24gPSAoIGRlbHRhID4gMCApID8gMSA6IC0xO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCBkaXJlY3Rpb24gKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGRpcmVjdGlvbiA8IDAgICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGlvbjIgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGlvbjIgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMCApXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICdtb3VzZXdoZWVsJzogZnVuY3Rpb24gKCBlICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVsdGEgPSBlLm9yaWdpbmFsRXZlbnQud2hlZWxEZWx0YTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBkZWx0YSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaXJlY3Rpb24gPSAoIGRlbHRhID4gMCApID8gLTEgOiAxO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCBkaXJlY3Rpb24gKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGRpcmVjdGlvbiA8IDAgICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGlvbjIgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FjdGlvbjIgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMCApXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uKGV2ZW50KXtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc3QgPSAkKHRoaXMpLnNjcm9sbFRvcCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdCA+IGxhc3RTY3JvbGxUb3Ape1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoIDEgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IDFcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfY2hlY2tTY3JvbGwoIC0xICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaXJlY3Rpb24gPSAtMVxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbGFzdFNjcm9sbFRvcCA9IHN0O1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICggZGlyZWN0aW9uIDwgMCAgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9hY3Rpb24yID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hY3Rpb24yID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIDMwMCApXG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgX3Nob3dNZW51QnRuLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoICQoIHRoaXMgKS5oYXNDbGFzcyggJ29wZW5lZCcgKSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jbG9zZU1lbnUoICQoIHRoaXMgKSApXG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9vcGVuTWVudSggJCggdGhpcyApICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfY2hlY2tTY3JvbGwgPSBmdW5jdGlvbiggZGlyZWN0aW9uICkge1xuXG4gICAgICAgICAgICAgICAgaWYoIGRpcmVjdGlvbiA+IDAgJiYgIV9vYmouaGFzQ2xhc3MoICdzaXRlX19oZWFkZXJfaGlkZGVuJyApICYmICFfc2hvd01lbnVCdG4uaGFzQ2xhc3MoICdvcGVuZWQnICkgJiYgX2FjdGlvbiAmJiAhX2FjdGlvbjIgKXtcblxuICAgICAgICAgICAgICAgICAgICBfb2JqLmFkZENsYXNzKCAnc2l0ZV9faGVhZGVyX2hpZGRlbicgKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmKCBkaXJlY3Rpb24gPCAwICYmIF9vYmouaGFzQ2xhc3MoICdzaXRlX19oZWFkZXJfaGlkZGVuJyApICYmICFfc2hvd01lbnVCdG4uaGFzQ2xhc3MoICdvcGVuZWQnICkgICYmIF9hY3Rpb24gJiYgX2FjdGlvbjIgJiYgZ2xvYmFsU2Nyb2xsRmxhZyApe1xuXG4gICAgICAgICAgICAgICAgICAgIF9vYmoucmVtb3ZlQ2xhc3MoJ3NpdGVfX2hlYWRlcl9oaWRkZW4nKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9jbG9zZU1lbnUgPSBmdW5jdGlvbiggZWxlbSApIHtcblxuICAgICAgICAgICAgICAgIF9odG1sLmNzcygge1xuICAgICAgICAgICAgICAgICAgICBvdmVyZmxvd1k6ICdhdXRvJ1xuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIGVsZW0ucmVtb3ZlQ2xhc3MoICdvcGVuZWQnICk7XG4gICAgICAgICAgICAgICAgX29iai5yZW1vdmVDbGFzcyggJ29wZW5lZC1tZW51JyApO1xuXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBfb2JqWyAwIF0ub2JqID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9vcGVuTWVudSA9IGZ1bmN0aW9uKCBlbGVtICkgIHtcblxuICAgICAgICAgICAgICAgIGVsZW0uYWRkQ2xhc3MoICdvcGVuZWQnICk7XG4gICAgICAgICAgICAgICAgX29iai5hZGRDbGFzcyggJ29wZW5lZC1tZW51JyApO1xuXG4gICAgICAgICAgICAgICAgX2h0bWwuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgIG92ZXJmbG93WTogJ2hpZGRlbidcbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuXG4gICAgdmFyIFNjcm9sbFBhbmVsID0gZnVuY3Rpb24gKCBvYmogKSB7XG5cbiAgICAgICAgdmFyIF9zZWxmID0gdGhpcyxcbiAgICAgICAgICAgIF9vYmogPSBvYmosXG4gICAgICAgICAgICBfbGlua3MgPSBfb2JqLFxuICAgICAgICAgICAgX2h0bWwgPSAkKCdodG1sJyksXG4gICAgICAgICAgICBfd2luZG93ID0gJCh3aW5kb3cpLFxuICAgICAgICAgICAgX2RvbSA9ICAkKCAnaHRtbCwgYm9keScpLFxuICAgICAgICAgICAgX2hlYWRlciA9ICQoJy5zaXRlX19oZWFkZXInKSxcbiAgICAgICAgICAgIF9wb3B1cCA9ICQoJy5wb3B1cF9fY29va2llcy1pbmZvJyk7XG5cbiAgICAgICAgdmFyIF9hZGRFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICBfd2luZG93Lm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIHJlc2l6ZTogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL19jaGFuZ2VBY3RpdmUoKTtcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnc2Nyb2xsJzogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvL19jaGFuZ2VBY3RpdmUoKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9ICk7XG4gICAgICAgICAgICAgICAgX2xpbmtzLm9uKCB7XG4gICAgICAgICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1ckl0ZW0gPSAkKCB0aGlzICksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q2xhc3MgPSBjdXJJdGVtLmF0dHIoJ2RhdGEtaHJlZicpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHRJdGVtVG9wID0gJCggJy4nICsgbmV3Q2xhc3MgICkub2Zmc2V0KCkudG9wIC0gX2hlYWRlci5pbm5lckhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfbGlua3MucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VySXRlbS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRJdGVtVG9wID0gJCggJy4nICsgbmV3Q2xhc3MgICkub2Zmc2V0KCkudG9wO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9kb20uc3RvcCggdHJ1ZSwgZmFsc2UgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9kb20uYW5pbWF0ZSgge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbFRvcDogbmV4dEl0ZW1Ub3BcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiA1MDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU2Nyb2xsRmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaGVhZGVyLmFkZENsYXNzKCAnc2l0ZV9faGVhZGVyX2hpZGRlbicgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnbG9iYWxTY3JvbGxGbGFnID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDIwMCApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2xvYmFsU2Nyb2xsRmxhZyA9IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgNTAwICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2h0bWwuY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3dZOiAnYXV0bydcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2hlYWRlci5maW5kKCcuc2l0ZV9fbWVudS1idG4nKS5yZW1vdmVDbGFzcyggJ29wZW5lZCcgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9oZWFkZXIucmVtb3ZlQ2xhc3MoICdvcGVuZWQtbWVudScgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfY2hhbmdlQWN0aXZlID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHNjcm9sbFRvcCA9ICQod2luZG93KS5zY3JvbGxUb3AoKSxcbiAgICAgICAgICAgICAgICAgICAgaXRlbSA9ICQoJ2JvZHknKS5maW5kKCdbZGF0YS1zY3JvbGw9XCJzY3JvbGxcIl0nKSxcbiAgICAgICAgICAgICAgICAgICAgaXRlbVBvcyA9IGl0ZW0ub2Zmc2V0KCkudG9wO1xuXG4gICAgICAgICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGl0ZW0ubGVuZ3RoOyBpKysgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1ciA9ICQoaXRlbVtpXSksXG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtQ3VyID0gJChpdGVtW2ldKS5vZmZzZXQoKS50b3AgLSBfaGVhZGVyLm91dGVySGVpZ2h0KHRydWUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbUhlaWdodCA9ICQoaXRlbVtpXSkub3V0ZXJIZWlnaHQodHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYoIHNjcm9sbFRvcCA+IGl0ZW1DdXIgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJDbGFzcyA9IGN1ci5hdHRyKCdjbGFzcycpLnNwbGl0KCcgJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VyTGluayA9IF9saW5rcy5maWx0ZXIoXCJbZGF0YS1ocmVmPVwiK2N1ckNsYXNzWzBdK1wiXVwiKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2xpbmtzLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1ckxpbmsuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYoIHNjcm9sbFRvcCA+ICggaXRlbUN1ciArIGl0ZW1IZWlnaHQgKSApe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfbGlua3MucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgX2luaXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBfb2JqWzBdLm9iaiA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9hZGRFdmVudHMoKTtcbiAgICAgICAgICAgICAgICAvL19jaGFuZ2VBY3RpdmUoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgX2luaXQoKTtcbiAgICB9O1xuXG4gICAgdmFyIFNsaWRlcyA9IGZ1bmN0aW9uIChvYmopIHtcblxuICAgICAgICAvL3ByaXZhdGUgcHJvcGVydGllc1xuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxuICAgICAgICAgICAgX29iaiA9IG9iaixcbiAgICAgICAgICAgIF93aW5kb3cgPSAkKHdpbmRvdyk7XG5cbiAgICAgICAgLy9wcml2YXRlIG1ldGhvZHNcbiAgICAgICAgdmFyIF9hZGRFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbih7XG4gICAgICAgICAgICAgICAgICAgIGxvYWQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHNjcm9sbDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2NoZWNrU2Nyb2xsKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfY2hlY2tTY3JvbGwgPSBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICAgICAgdmFyIGN1clNjcm9sbCA9IF93aW5kb3cuc2Nyb2xsVG9wKCksXG4gICAgICAgICAgICAgICAgICAgIHdpbmRvd0ggPSBfd2luZG93LmhlaWdodCgpLFxuICAgICAgICAgICAgICAgICAgICB0b3BQb3MgPSBfb2JqLm9mZnNldCgpLnRvcCxcbiAgICAgICAgICAgICAgICAgICAgdG9wSW5XaW5kb3cgPSB0b3BQb3MtY3VyU2Nyb2xsLFxuICAgICAgICAgICAgICAgICAgICB2aXNpYmxlUGVyY2VudCA9IDEtKHRvcEluV2luZG93L3dpbmRvd0gpO1xuXG4gICAgICAgICAgICAgICAgaWYoIHZpc2libGVQZXJjZW50ID4gLjUgKXtcbiAgICAgICAgICAgICAgICAgICAgaWYoICFfb2JqLmhhc0NsYXNzKCdzbGlkZXNfYWN0aXZlJykgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9vYmouYWRkQ2xhc3MoJ3NsaWRlc19hY3RpdmUnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF9vYmpbMF0uc2xpZGVzID0gX3NlbGY7XG4gICAgICAgICAgICAgICAgX2FkZEV2ZW50cygpO1xuXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIC8vcHVibGljIHByb3BlcnRpZXNcblxuICAgICAgICAvL3B1YmxpYyBtZXRob2RzXG5cblxuICAgICAgICBfaW5pdCgpO1xuICAgIH07XG5cbiAgICB2YXIgRnVsbEhlaWdodCA9IGZ1bmN0aW9uIChvYmopIHtcblxuICAgICAgICAvL3ByaXZhdGUgcHJvcGVydGllc1xuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxuICAgICAgICAgICAgX29iaiA9IG9iaixcbiAgICAgICAgICAgIF93aW5kb3cgPSAkKHdpbmRvdyksXG4gICAgICAgICAgICBfaGVhZGVyID0gJCgnLnNpdGVfX2hlYWRlcicpLFxuICAgICAgICAgICAgX2dsb2JhbFdpZHRoID0gMDtcblxuICAgICAgICAvL3ByaXZhdGUgbWV0aG9kc1xuICAgICAgICB2YXIgX2FkZEV2ZW50cyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgX3dpbmRvdy5vbigge1xuICAgICAgICAgICAgICAgICAgICBsb2FkOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9nbG9iYWxXaWR0aCA9IF93aW5kb3cud2lkdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9zZXRIZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICByZXNpemU6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIF9nbG9iYWxXaWR0aCAhPSBfd2luZG93LndpZHRoKCkgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZ2xvYmFsV2lkdGggPSBfd2luZG93LndpZHRoKCkgKyAxO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3NldEhlaWdodCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgX29ialsgMCBdLm9iaiA9IF9zZWxmO1xuICAgICAgICAgICAgICAgIF9hZGRFdmVudHMoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfc2V0SGVpZ2h0ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgaGVpZ2h0ID0gX3dpbmRvdy5oZWlnaHQoKTtcblxuICAgICAgICAgICAgICAgIF9vYmouY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICdtaW4taGVpZ2h0JzogaGVpZ2h0IC0gX2hlYWRlci5pbm5lckhlaWdodCgpIC0gJCgnLnNpdGVfX21haW4tdGl0bGUnKS5vdXRlckhlaWdodCh0cnVlKVxuICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgIGlmKCBfb2JqLmZpbmQoJy5jb250YWN0LXVzJykubGVuZ3RoICkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCBfd2luZG93LndpZHRoKCkgPj0gMTAyNCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX29iai5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbWluLWhlaWdodCc6ICcnXG4gICAgICAgICAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX29iai5jc3MoIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbWluLWhlaWdodCc6IGhlaWdodCAtIF9oZWFkZXIuaW5uZXJIZWlnaHQoKSAtICQoJy5zaXRlX19tYWluLXRpdGxlJykub3V0ZXJIZWlnaHQodHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIF9vYmouY3NzKCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnbWluLWhlaWdodCc6IGhlaWdodCAtIF9oZWFkZXIuaW5uZXJIZWlnaHQoKSAtICQoJy5zaXRlX19tYWluLXRpdGxlJykub3V0ZXJIZWlnaHQodHJ1ZSlcbiAgICAgICAgICAgICAgICAgICAgfSApO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxuICAgIHZhciBTY3JvbGxUb0hhc2ggPSBmdW5jdGlvbiAoIG9iaiApIHtcblxuICAgICAgICB2YXIgX3NlbGYgPSB0aGlzLFxuICAgICAgICAgICAgX29iaiA9IG9iaixcbiAgICAgICAgICAgIF93aW5kb3cgPSAkKHdpbmRvdyksXG4gICAgICAgICAgICBfZG9tID0gICQoJ2h0bWwsIGJvZHknKTtcblxuICAgICAgICB2YXIgX2FkZEV2ZW50cyA9IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIF93aW5kb3cub24oIHtcbiAgICAgICAgICAgICAgICAgICAgbG9hZDogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zY3JvbGxUbygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDAgKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9ICk7XG5cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBfc2Nyb2xsVG8gPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgIHZhciBoYXNoID0gd2luZG93LmxvY2F0aW9uLmhhc2gucmVwbGFjZSgnIycsICcnKTtcblxuICAgICAgICAgICAgICAgIGlmKCBoYXNoICkge1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBlbGVtID0gJCggJy4nICsgd2luZG93LmxvY2F0aW9uLmhhc2gucmVwbGFjZSgnIycsICcnKSApO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCBlbGVtLmxlbmd0aCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnNjcm9sbFRvKCAwLCBwYXJzZUludCggZWxlbS5vZmZzZXQoKS50b3AgKSApO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF9pbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgX29ialswXS5vYmogPSBfc2VsZjtcbiAgICAgICAgICAgICAgICBfYWRkRXZlbnRzKCk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIF9pbml0KCk7XG4gICAgfTtcblxufSApKCk7Il19
